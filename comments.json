// Funkcja do tworzenia comments.json jeśli nie istnieje
async function initializeCommentsFile() {
    try {
        const url = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/comments.json`;
        const headers = GITHUB_TOKEN ? {
            'Authorization': `token ${GITHUB_TOKEN}`,
            'Accept': 'application/vnd.github.v3+json'
        } : {};
        
        const response = await fetch(url, { headers });
        
        if (response.status === 404) {
            // Plik nie istnieje - stwórz go
            console.log('Tworzę plik comments.json...');
            
            if (!GITHUB_TOKEN) {
                console.warn('Brak tokena - nie mogę stworzyć pliku');
                return false;
            }
            
            const initialComments = []; // Pusta tablica
            
            const content = JSON.stringify(initialComments, null, 2);
            const contentBase64 = btoa(unescape(encodeURIComponent(content)));
            
            const body = {
                message: "Inicjalizacja pliku komentarzy",
                content: contentBase64,
                branch: "main"
            };
            
            const createResponse = await fetch(url, {
                method: 'PUT',
                headers: headers,
                body: JSON.stringify(body)
            });
            
            if (createResponse.ok) {
                console.log('Plik comments.json został utworzony!');
                return true;
            }
        }
        
        return false;
    } catch (error) {
        console.error('Błąd inicjalizacji comments.json:', error);
        return false;
    }
}

// Dodaj wywołanie przy ładowaniu strony
document.addEventListener('DOMContentLoaded', function() {
    // ... inne inicjalizacje ...
    
    // Sprawdź i stwórz comments.json jeśli potrzeba
    if (GITHUB_TOKEN) {
        setTimeout(initializeCommentsFile, 2000);
    }
});
